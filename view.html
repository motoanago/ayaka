<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>誕生日リスト</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  select { margin-bottom: 20px; padding: 5px; font-size: 16px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  th { background-color: #f2f2f2; }
</style>
</head>
<body>

<h2>誕生日リスト</h2>

<label for="monthSelect">月を選択:</label>
<select id="monthSelect">
  <option value="ALL">ALL</option>
  <option value="1">1月</option>
  <option value="2">2月</option>
  <option value="3">3月</option>
  <option value="4">4月</option>
  <option value="5">5月</option>
  <option value="6">6月</option>
  <option value="7">7月</option>
  <option value="8">8月</option>
  <option value="9">9月</option>
  <option value="10">10月</option>
  <option value="11">11月</option>
  <option value="12">12月</option>
</select>

<table id="birthdayTable">
  <thead>
    <tr>
      <th>名前</th>
      <th>誕生日</th>
      <th>メモ</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const apiURL = "https://script.google.com/macros/s/AKfycbxqz6mBCZrMioqnBY70R1Tv3dY6GYvAKVn9OfVBWlE_gLC3otbfsB2BrIwNGrw0b2xn/exec";

let birthdayData = [];

// データ取得
async function fetchData() {
  try {
    const res = await fetch(apiURL);
    const data = await res.json();
    birthdayData = data;
    displayData("ALL");
  } catch (err) {
    console.error("データ取得エラー:", err);
    alert("データを取得できませんでした。");
  }
}

// 表示関数
function displayData(monthFilter) {
  const tbody = document.querySelector("#birthdayTable tbody");
  tbody.innerHTML = "";

  let filtered = birthdayData;
  if (monthFilter !== "ALL") {
    filtered = birthdayData.filter(d => d.month === parseInt(monthFilter,10));
  }

  filtered.sort((a,b) => a.month - b.month || a.day - b.day);

  for (const item of filtered) {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${item.name}</td><td>${item.month}月${item.day}日</td><td>${item.memo}</td>`;
    tbody.appendChild(tr);
  }
}

// プルダウン変更時
document.getElementById("monthSelect").addEventListener("change", e => {
  displayData(e.target.value);
});

// 初回表示
fetchData();
</script>

</body>
</html>
